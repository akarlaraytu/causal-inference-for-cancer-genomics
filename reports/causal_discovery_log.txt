[02:03:31] [INFO] 
================================================================================
[02:03:31] [INFO]   RIGOROUS CAUSAL DISCOVERY PIPELINE
[02:03:31] [INFO] ================================================================================

[02:03:31] [INFO] üî¨ Academic-grade causal inference for genomic discovery
[02:03:31] [INFO] Random seed: 42
[02:03:31] [INFO] 
================================================================================
[02:03:31] [INFO]   PHASE 1: DATA PREPARATION
[02:03:31] [INFO] ================================================================================

[02:03:31] [INFO] Loading merged dataset...
[02:03:32] [INFO]   Dataset shape: (967, 8667)
[02:03:32] [INFO]   Genes: 8655
[02:03:32] [INFO]   Patients: 967
[02:03:32] [INFO] 
üîß Constructing confounder matrix (W)...
[02:03:32] [INFO]   Selected confounders: ['age', 'stage', 'diagnosis']
[02:03:32] [WARN]   ‚ö†Ô∏è  Imputing 41 missing values in age with median=58.76
[02:03:32] [INFO]   Final W shape: (967, 15)
[02:03:32] [INFO]   W columns: ['age', 'stage_II', 'stage_III', 'stage_IV', 'stage_Unknown', 'diagnosis_Infiltrating duct carcinoma, NOS', 'diagnosis_Infiltrating duct mixed with other types of carcinoma', 'diagnosis_Infiltrating lobular mixed with other types of carcinoma', 'diagnosis_Intraductal papillary adenocarcinoma with invasion', 'diagnosis_Lobular carcinoma, NOS', 'diagnosis_Medullary carcinoma, NOS', 'diagnosis_Metaplastic carcinoma, NOS', 'diagnosis_Mucinous adenocarcinoma', 'diagnosis_Not Reported', 'diagnosis_Other']
[02:03:32] [INFO] 
üìä Outcome distribution:
[02:03:32] [INFO]   Alive: 834 (86.2%)
[02:03:32] [INFO]   Dead: 133 (13.8%)
[02:03:32] [INFO] 
üîç Data quality checks:
[02:03:32] [INFO]   ‚úì No NaN in outcome
[02:03:32] [INFO]   ‚úì No NaN in confounders
[02:03:32] [INFO]   Gene matrix sparsity: 99.36%
[02:03:32] [INFO] 
================================================================================
[02:03:32] [INFO]   PHASE 2: SCREENING (FISHER EXACT + FDR)
[02:03:32] [INFO] ================================================================================

[02:03:32] [INFO] Testing 8655 genes...
[02:03:32] [INFO] Minimum mutation threshold: 5
[02:03:33] [INFO] 
üìä Screening summary:
[02:03:33] [INFO]   Genes tested: 4654
[02:03:33] [INFO]   Genes filtered (n<5): 4001
[02:03:33] [INFO] 
üéØ FDR correction (Benjamini-Yekutieli)...
[02:03:33] [INFO]   Method: Controls FDR under arbitrary dependence
[02:03:33] [INFO]   Alpha: 0.2
[02:03:33] [INFO]   BY correction factor c(n): 9.023
[02:03:33] [INFO] 
  Results:
[02:03:33] [INFO]     Genes passing FDR threshold: 4654 / 4654
[02:03:33] [INFO]     FDR rate: 100.0%
[02:03:33] [INFO] 
  üîù Top 10 candidates:
[02:03:33] [INFO]     A1CF: OR=1.256, q=0.0328
[02:03:33] [INFO]     A2M: OR=0.000, q=0.0328
[02:03:33] [INFO]     A2ML1: OR=0.000, q=0.0328
[02:03:33] [INFO]     AADAC: OR=0.000, q=0.0328
[02:03:33] [INFO]     AAK1: OR=1.045, q=0.0328
[02:03:33] [INFO]     AARS1: OR=0.624, q=0.0328
[02:03:33] [INFO]     AASDH: OR=4.788, q=0.0328
[02:03:33] [INFO]     ABCA1: OR=0.782, q=0.0328
[02:03:33] [INFO]     ABCA10: OR=1.902, q=0.0328
[02:03:33] [INFO]     ABCA12: OR=1.958, q=0.0328
[02:03:34] [INFO] 
‚úì Screening results saved: results/causal_discovery/screening_results.csv
[02:03:34] [INFO] 
================================================================================
[02:03:34] [INFO]   PHASE 3: CAUSAL ESTIMATION
[02:03:34] [INFO] ================================================================================

[02:03:34] [INFO] Limiting analysis to top 15 genes
[02:03:34] [INFO] Analyzing 15 candidate genes...
[02:03:34] [INFO] Methods: Causal Forest, Double ML, TMLE, Permutation Test
[02:03:34] [INFO] 
============================================================
[02:03:34] [INFO] Gene: A1CF (1/15)
[02:03:34] [INFO] ============================================================
[02:03:34] [INFO]   Mutated: 6 / 967 (0.6%)
[02:03:34] [INFO]   [1/5] Propensity diagnostics...
[02:03:34] [INFO]     Overlap quality: poor
[02:03:34] [INFO]     Extreme propensity: 100.0%
[02:03:34] [INFO]   [2/5] Causal Forest (bootstrap n=200)...
[02:03:35] [INFO]     Status: estimation_failed
[02:03:35] [INFO]   [3/5] Double ML...
[02:03:38] [INFO]     ATE = 0.0172 [-0.2687, 0.3031]
[02:03:38] [INFO]   [4/5] TMLE...
[02:03:38] [INFO]     ATE = 0.0793 [-0.1139, 0.2724]
[02:03:38] [INFO]   [5/5] Permutation test (n=500)...
[02:03:38] [INFO]     Skipped (no valid ATE)
[02:03:38] [INFO] 
============================================================
[02:03:38] [INFO] Gene: PPFIA2 (3106/15)
[02:03:38] [INFO] ============================================================
[02:03:38] [INFO]   Mutated: 12 / 967 (1.2%)
[02:03:38] [INFO]   [1/5] Propensity diagnostics...
[02:03:38] [INFO]     Overlap quality: poor
[02:03:38] [INFO]     Extreme propensity: 100.0%
[02:03:38] [INFO]   [2/5] Causal Forest (bootstrap n=200)...
[02:03:38] [INFO]     Status: estimation_failed
[02:03:38] [INFO]   [3/5] Double ML...
[02:03:40] [INFO]     ATE = -0.1072 [-0.2782, 0.0639]
[02:03:40] [INFO]   [4/5] TMLE...
[02:03:40] [INFO]     ATE = -0.0971 [-0.1718, -0.0224]
[02:03:40] [INFO]   [5/5] Permutation test (n=500)...
[02:03:40] [INFO]     Skipped (no valid ATE)
[02:03:40] [INFO] 
============================================================
[02:03:40] [INFO] Gene: PPFIA1 (3105/15)
[02:03:40] [INFO] ============================================================
[02:03:40] [INFO]   Mutated: 8 / 967 (0.8%)
[02:03:40] [INFO]   [1/5] Propensity diagnostics...
[02:03:40] [INFO]     Overlap quality: poor
[02:03:40] [INFO]     Extreme propensity: 100.0%
[02:03:40] [INFO]   [2/5] Causal Forest (bootstrap n=200)...
[02:03:40] [INFO]     Status: estimation_failed
[02:03:40] [INFO]   [3/5] Double ML...
[02:03:42] [INFO]     ATE = -0.0106 [-0.2252, 0.2040]
[02:03:42] [INFO]   [4/5] TMLE...
[02:03:42] [INFO]     ATE = -0.0536 [-0.1304, 0.0232]
[02:03:42] [INFO]   [5/5] Permutation test (n=500)...
[02:03:42] [INFO]     Skipped (no valid ATE)
[02:03:42] [INFO] 
============================================================
[02:03:42] [INFO] Gene: PPEF2 (3104/15)
[02:03:42] [INFO] ============================================================
[02:03:42] [INFO]   Mutated: 7 / 967 (0.7%)
[02:03:42] [INFO]   [1/5] Propensity diagnostics...
[02:03:42] [INFO]     Overlap quality: poor
[02:03:42] [INFO]     Extreme propensity: 100.0%
[02:03:42] [INFO]   [2/5] Causal Forest (bootstrap n=200)...
[02:03:42] [INFO]     Status: estimation_failed
[02:03:42] [INFO]   [3/5] Double ML...
[02:03:44] [INFO]     ATE = 0.0376 [-0.2202, 0.2954]
[02:03:44] [INFO]   [4/5] TMLE...
[02:03:44] [INFO]     ATE = -0.0460 [-0.0979, 0.0059]
[02:03:44] [INFO]   [5/5] Permutation test (n=500)...
[02:03:44] [INFO]     Skipped (no valid ATE)
[02:03:44] [INFO] 
============================================================
[02:03:44] [INFO] Gene: PPEF1 (3103/15)
[02:03:44] [INFO] ============================================================
[02:03:44] [INFO]   Mutated: 12 / 967 (1.2%)
[02:03:44] [INFO]   [1/5] Propensity diagnostics...
[02:03:44] [INFO]     Overlap quality: poor
[02:03:44] [INFO]     Extreme propensity: 100.0%
[02:03:44] [INFO]   [2/5] Causal Forest (bootstrap n=200)...
[02:03:44] [INFO]     Status: estimation_failed
[02:03:44] [INFO]   [3/5] Double ML...
[02:03:46] [INFO]     ATE = 0.0378 [-0.1814, 0.2571]
[02:03:46] [INFO]   [4/5] TMLE...
[02:03:46] [INFO]     ATE = 0.0649 [-0.1431, 0.2729]
[02:03:46] [INFO]   [5/5] Permutation test (n=500)...
[02:03:46] [INFO]     Skipped (no valid ATE)
[02:03:46] [INFO] 
============================================================
[02:03:46] [INFO] Gene: PPARGC1B (3102/15)
[02:03:46] [INFO] ============================================================
[02:03:46] [INFO]   Mutated: 7 / 967 (0.7%)
[02:03:46] [INFO]   [1/5] Propensity diagnostics...
[02:03:46] [INFO]     Overlap quality: poor
[02:03:46] [INFO]     Extreme propensity: 100.0%
[02:03:46] [INFO]   [2/5] Causal Forest (bootstrap n=200)...
[02:03:46] [INFO]     Status: estimation_failed
[02:03:46] [INFO]   [3/5] Double ML...
[02:03:49] [INFO]     ATE = 0.4191 [0.0662, 0.7719]
[02:03:49] [INFO]   [4/5] TMLE...
[02:03:49] [INFO]     ATE = 0.2777 [0.0667, 0.4886]
[02:03:49] [INFO]   [5/5] Permutation test (n=500)...
[02:03:49] [INFO]     Skipped (no valid ATE)
[02:03:49] [INFO] 
============================================================
[02:03:49] [INFO] Gene: PPARGC1A (3101/15)
[02:03:49] [INFO] ============================================================
[02:03:49] [INFO]   Mutated: 9 / 967 (0.9%)
[02:03:49] [INFO]   [1/5] Propensity diagnostics...
[02:03:49] [INFO]     Overlap quality: poor
[02:03:49] [INFO]     Extreme propensity: 100.0%
[02:03:49] [INFO]   [2/5] Causal Forest (bootstrap n=200)...
[02:03:49] [INFO]     Status: estimation_failed
[02:03:49] [INFO]   [3/5] Double ML...
[02:03:51] [INFO]     ATE = 0.1376 [-0.1181, 0.3933]
[02:03:51] [INFO]   [4/5] TMLE...
[02:03:51] [INFO]     ATE = 0.0645 [-0.1245, 0.2534]
[02:03:51] [INFO]   [5/5] Permutation test (n=500)...
[02:03:51] [INFO]     Skipped (no valid ATE)
[02:03:51] [INFO] 
============================================================
[02:03:51] [INFO] Gene: PPFIA3 (3107/15)
[02:03:51] [INFO] ============================================================
[02:03:51] [INFO]   Mutated: 5 / 967 (0.5%)
[02:03:51] [INFO]   [1/5] Propensity diagnostics...
[02:03:51] [INFO]     Overlap quality: poor
[02:03:51] [INFO]     Extreme propensity: 100.0%
[02:03:51] [INFO]   [2/5] Causal Forest (bootstrap n=200)...
[02:03:51] [INFO]     Status: estimation_failed
[02:03:51] [INFO]   [3/5] Double ML...
[02:03:53] [INFO]     ATE = -0.1049 [-0.1619, -0.0480]
[02:03:53] [INFO]   [4/5] TMLE...
[02:03:53] [INFO]     ATE = -0.0725 [-0.1114, -0.0336]
[02:03:53] [INFO]   [5/5] Permutation test (n=500)...
[02:03:53] [INFO]     Skipped (no valid ATE)
[02:03:53] [INFO] 
============================================================
[02:03:53] [INFO] Gene: PPARG (3100/15)
[02:03:53] [INFO] ============================================================
[02:03:53] [INFO]   Mutated: 6 / 967 (0.6%)
[02:03:53] [INFO]   [1/5] Propensity diagnostics...
[02:03:53] [INFO]     Overlap quality: poor
[02:03:53] [INFO]     Extreme propensity: 100.0%
[02:03:53] [INFO]   [2/5] Causal Forest (bootstrap n=200)...
[02:03:53] [INFO]     Status: estimation_failed
[02:03:53] [INFO]   [3/5] Double ML...
[02:03:55] [INFO]     ATE = -0.1881 [-0.3468, -0.0293]
[02:03:55] [INFO]   [4/5] TMLE...
[02:03:55] [INFO]     ATE = -0.1178 [-0.1934, -0.0422]
[02:03:55] [INFO]   [5/5] Permutation test (n=500)...
[02:03:55] [INFO]     Skipped (no valid ATE)
[02:03:55] [INFO] 
============================================================
[02:03:55] [INFO] Gene: POU5F2 (3098/15)
[02:03:55] [INFO] ============================================================
[02:03:55] [INFO]   Mutated: 5 / 967 (0.5%)
[02:03:55] [INFO]   [1/5] Propensity diagnostics...
[02:03:55] [INFO]     Overlap quality: poor
[02:03:55] [INFO]     Extreme propensity: 100.0%
[02:03:55] [INFO]   [2/5] Causal Forest (bootstrap n=200)...
[02:03:55] [INFO]     Status: estimation_failed
[02:03:55] [INFO]   [3/5] Double ML...
[02:03:57] [INFO]     ATE = 0.0191 [-0.3032, 0.3415]
[02:03:57] [INFO]   [4/5] TMLE...
[02:03:57] [INFO]     ATE = 0.0300 [-0.0865, 0.1464]
[02:03:57] [INFO]   [5/5] Permutation test (n=500)...
[02:03:57] [INFO]     Skipped (no valid ATE)
[02:03:57] [INFO] 
============================================================
[02:03:57] [INFO] Gene: POU4F2 (3097/15)
[02:03:57] [INFO] ============================================================
[02:03:57] [INFO]   Mutated: 5 / 967 (0.5%)
[02:03:57] [INFO]   [1/5] Propensity diagnostics...
[02:03:57] [INFO]     Overlap quality: poor
[02:03:57] [INFO]     Extreme propensity: 100.0%
[02:03:57] [INFO]   [2/5] Causal Forest (bootstrap n=200)...
[02:03:57] [INFO]     Status: estimation_failed
[02:03:57] [INFO]   [3/5] Double ML...
[02:04:00] [INFO]     ATE = 0.1989 [-0.2240, 0.6218]
[02:04:00] [INFO]   [4/5] TMLE...
[02:04:00] [INFO]     ATE = 0.1178 [-0.0613, 0.2968]
[02:04:00] [INFO]   [5/5] Permutation test (n=500)...
[02:04:00] [INFO]     Skipped (no valid ATE)
[02:04:00] [INFO] 
============================================================
[02:04:00] [INFO] Gene: POU3F4 (3096/15)
[02:04:00] [INFO] ============================================================
[02:04:00] [INFO]   Mutated: 8 / 967 (0.8%)
[02:04:00] [INFO]   [1/5] Propensity diagnostics...
[02:04:00] [INFO]     Overlap quality: poor
[02:04:00] [INFO]     Extreme propensity: 99.8%
[02:04:00] [INFO]   [2/5] Causal Forest (bootstrap n=200)...
[02:04:00] [INFO]     Status: estimation_failed
[02:04:00] [INFO]   [3/5] Double ML...
[02:04:02] [INFO]     ATE = -0.2258 [-0.3358, -0.1158]
[02:04:02] [INFO]   [4/5] TMLE...
[02:04:02] [INFO]     ATE = -0.1030 [-0.1430, -0.0630]
[02:04:02] [INFO]   [5/5] Permutation test (n=500)...
[02:04:02] [INFO]     Skipped (no valid ATE)
[02:04:02] [INFO] 
============================================================
[02:04:02] [INFO] Gene: POU2F2 (3095/15)
[02:04:02] [INFO] ============================================================
[02:04:02] [INFO]   Mutated: 5 / 967 (0.5%)
[02:04:02] [INFO]   [1/5] Propensity diagnostics...
[02:04:02] [INFO]     Overlap quality: poor
[02:04:02] [INFO]     Extreme propensity: 100.0%
[02:04:02] [INFO]   [2/5] Causal Forest (bootstrap n=200)...
[02:04:02] [INFO]     Status: estimation_failed
[02:04:02] [INFO]   [3/5] Double ML...
[02:04:04] [INFO]     ATE = -0.1411 [-0.2258, -0.0565]
[02:04:04] [INFO]   [4/5] TMLE...
[02:04:04] [INFO]     ATE = -0.0682 [-0.1091, -0.0273]
[02:04:04] [INFO]   [5/5] Permutation test (n=500)...
[02:04:04] [INFO]     Skipped (no valid ATE)
[02:04:04] [INFO] 
============================================================
[02:04:04] [INFO] Gene: POTEF (3094/15)
[02:04:04] [INFO] ============================================================
[02:04:04] [INFO]   Mutated: 6 / 967 (0.6%)
[02:04:04] [INFO]   [1/5] Propensity diagnostics...
[02:04:04] [INFO]     Overlap quality: poor
[02:04:04] [INFO]     Extreme propensity: 100.0%
[02:04:04] [INFO]   [2/5] Causal Forest (bootstrap n=200)...
[02:04:04] [INFO]     Status: estimation_failed
[02:04:04] [INFO]   [3/5] Double ML...
[02:04:06] [INFO]     ATE = -0.2241 [-0.3326, -0.1155]
[02:04:06] [INFO]   [4/5] TMLE...
[02:04:06] [INFO]     ATE = -0.1401 [-0.2135, -0.0667]
[02:04:06] [INFO]   [5/5] Permutation test (n=500)...
[02:04:06] [INFO]     Skipped (no valid ATE)
[02:04:06] [INFO] 
============================================================
[02:04:06] [INFO] Gene: POTEA (3093/15)
[02:04:06] [INFO] ============================================================
[02:04:06] [INFO]   Mutated: 5 / 967 (0.5%)
[02:04:06] [INFO]   [1/5] Propensity diagnostics...
[02:04:06] [INFO]     Overlap quality: poor
[02:04:06] [INFO]     Extreme propensity: 100.0%
[02:04:06] [INFO]   [2/5] Causal Forest (bootstrap n=200)...
[02:04:06] [INFO]     Status: estimation_failed
[02:04:06] [INFO]   [3/5] Double ML...
[02:04:08] [INFO]     ATE = -0.0771 [-0.1033, -0.0509]
[02:04:08] [INFO]   [4/5] TMLE...
[02:04:08] [INFO]     ATE = -0.0623 [-0.0970, -0.0275]
[02:04:08] [INFO]   [5/5] Permutation test (n=500)...
[02:04:08] [INFO]     Skipped (no valid ATE)
[02:04:08] [INFO] 
================================================================================
[02:04:08] [INFO] FINAL FDR CORRECTION (Permutation p-values)
[02:04:08] [INFO] ================================================================================

[02:04:08] [WARN] ‚ö†Ô∏è  No valid permutation p-values for FDR correction
[02:04:08] [INFO] 
‚úì Causal estimates saved: results/causal_discovery/causal_estimates.csv
[02:04:08] [INFO] 
================================================================================
[02:04:08] [INFO]   PHASE 4: GENERATE VISUALIZATIONS
[02:04:08] [INFO] ================================================================================

[02:04:08] [INFO] Creating visualizations...
[02:04:09] [INFO]   ‚úì Saved: figures/causal/forest_plot_methods.png
[02:04:09] [INFO]   ‚úì Saved: figures/causal/fdr_volcano.png
[02:04:09] [INFO] 
‚úì All visualizations saved to figures/causal/